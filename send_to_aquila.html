<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Aquila Inbox • Keeper Signal Sender</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    body {
      background: #050914;
      color: #e5f0ff;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 18px;
    }

    .card {
      max-width: 720px;
      margin: 0 auto;
      background: radial-gradient(circle at top left, #1c2940, #050914);
      border-radius: 18px;
      padding: 22px;
      box-shadow: 0 18px 45px rgba(0,0,0,0.55);
      border: 1px solid rgba(120,190,255,0.18);
    }

    h1 {
      margin: 0 0 6px;
      font-size: 1.8rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .sub {
      font-size: 0.85rem;
      opacity: 0.8;
      margin-bottom: 14px;
      line-height: 1.4;
    }

    label {
      display: block;
      font-size: 0.82rem;
      margin-top: 14px;
      margin-bottom: 4px;
      letter-spacing: 0.07em;
      opacity: 0.85;
      text-transform: uppercase;
    }

    input, textarea, select {
      width: 100%;
      box-sizing: border-box;
      background: rgba(4,12,24,0.85);
      border: 1px solid rgba(120,190,255,0.4);
      color: #e5f0ff;
      border-radius: 10px;
      padding: 9px 11px;
      font-size: 0.92rem;
      outline: none;
    }

    input:focus, textarea:focus, select:focus {
      border-color: #5cf2a5;
      box-shadow: 0 0 0 1px rgba(92,242,165,0.45);
    }

    textarea {
      min-height: 130px;
      resize: vertical;
    }

    .row {
      display: flex;
      gap: 10px;
      margin-top: 6px;
    }

    .row > div { flex: 1; }

    button {
      margin-top: 18px;
      width: 100%;
      padding: 12px;
      border-radius: 999px;
      border: none;
      font-size: 1rem;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: linear-gradient(135deg, #29f090, #3cf0ff);
      color: #041016;
      cursor: pointer;
      box-shadow: 0 12px 32px rgba(0,0,0,0.6);
    }

    button:disabled {
      opacity: 0.55;
      cursor: default;
      box-shadow: none;
    }

    .status {
      margin-top: 12px;
      font-size: 0.82rem;
      min-height: 1.5em;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .status.ok { color: #5cf2a5; }
    .status.err { color: #ff8790; }

    .hint {
      font-size: 0.7rem;
      opacity: 0.75;
    }
  </style>
</head>

<body>
  <div class="card">
    <h1>Aquila Inbox</h1>
    <div class="sub">
      Manual Sky-Mind signal sender.<br />
      Worker endpoint:<br />
      <code>https://brandonmarkgaia.workers.dev/inbox</code>
    </div>

    <label for="secret">Keeper Secret (AQUILA_INBOX_SECRET)</label>
    <input id="secret" type="password" autocomplete="off" placeholder="Paste your secret…" />
    <div class="hint">
      Stored only in your browser. Sent only as HTTPS Authorization header.
    </div>

    <label for="title">Title</label>
    <input id="title" type="text" placeholder="Message title" />

    <label for="summary">Summary</label>
    <input id="summary" type="text" placeholder="Short summary" />

    <label for="body">Body</label>
    <textarea id="body" placeholder="Full whisper, update, or Keeper signal…"></textarea>

    <div class="row">
      <div>
        <label for="priority">Priority</label>
        <select id="priority">
          <option value="normal">Normal</option>
          <option value="high">High</option>
          <option value="low">Low</option>
        </select>
      </div>

      <div>
        <label for="tags">Tags</label>
        <input id="tags" type="text" placeholder="keeper, init, sky" />
      </div>
    </div>

    <button id="sendBtn">Send to Aquila</button>
    <div id="status" class="status"></div>
  </div>

  <script>
    const ENDPOINT = "https://brandonmarkgaia.workers.dev/inbox";

    const $ = id => document.getElementById(id);
    const secretInput = $("secret");
    const titleInput = $("title");
    const summaryInput = $("summary");
    const bodyInput = $("body");
    const priorityInput = $("priority");
    const tagsInput = $("tags");
    const statusBox = $("status");
    const sendBtn = $("sendBtn");

    function showStatus(msg, type = "") {
      statusBox.textContent = msg;
      statusBox.className = "status " + type;
    }

    async function sendMessage() {
      const secret = secretInput.value.trim();
      if (!secret) return showStatus("Missing Keeper Secret.", "err");

      const payload = {
        title: titleInput.value.trim() || "Untitled Keeper Message",
        summary: summaryInput.value.trim() || "No summary.",
        body: bodyInput.value.trim() || "",
        priority: priorityInput.value,
        tags: tagsInput.value.split(",").map(t => t.trim()).filter(Boolean)
      };

      showStatus("Sending to Aquila…");
      sendBtn.disabled = true;

      try {
        const res = await fetch(ENDPOINT, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: "Bearer " + secret
          },
          body: JSON.stringify(payload)
        });

        const text = await res.text();
        let data;

        try { data = JSON.parse(text); }
        catch { data = { raw: text }; }

        if (!res.ok || !data.ok) {
          showStatus("Error " + res.status + ": " + JSON.stringify(data, null, 2), "err");
        } else {
          showStatus("✓ Message delivered. ID: " + data.id, "ok");
        }
      } catch (err) {
        showStatus("Network error: " + err.message, "err");
      }

      sendBtn.disabled = false;
    }

    sendBtn.addEventListener("click", sendMessage);
  </script>
</body>
</html>
